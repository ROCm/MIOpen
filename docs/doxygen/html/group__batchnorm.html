<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MIOpen: Batchnorm</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MIOpen
   &#160;<span id="projectnumber">v5.4.4</span>
   </div>
   <div id="projectbrief">AMD&#39;s Machine Intelligence Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Batchnorm</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:gab21179fc753f8e0d1a6f23ac9b340a26"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__batchnorm.html#gab21179fc753f8e0d1a6f23ac9b340a26">miopenBatchNormMode_t</a> { <br />
&#160;&#160;<a class="el" href="group__batchnorm.html#gab21179fc753f8e0d1a6f23ac9b340a26a44ab9eadea90a770a3744a61b71d536f">miopenBNPerActivation</a> = 0
, <br />
&#160;&#160;<a class="el" href="group__batchnorm.html#gab21179fc753f8e0d1a6f23ac9b340a26a42ebad7a4f774e7dc3df2de80b31a3e0">miopenBNSpatial</a> = 1
<br />
 }</td></tr>
<tr class="separator:gab21179fc753f8e0d1a6f23ac9b340a26"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaf2aef2cbd792e82b32b305039d6e4662"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__handle.html#ga74216ea6ba6c5487d5aceb46eb35f1d6">miopenStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__batchnorm.html#gaf2aef2cbd792e82b32b305039d6e4662">miopenDeriveBNTensorDescriptor</a> (miopenTensorDescriptor_t derivedBnDesc, const miopenTensorDescriptor_t xDesc, <a class="el" href="group__batchnorm.html#gab21179fc753f8e0d1a6f23ac9b340a26">miopenBatchNormMode_t</a> bn_mode)</td></tr>
<tr class="memdesc:gaf2aef2cbd792e82b32b305039d6e4662"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derive tensor for gamma and beta from input tensor descriptor.  <a href="group__batchnorm.html#gaf2aef2cbd792e82b32b305039d6e4662">More...</a><br /></td></tr>
<tr class="separator:gaf2aef2cbd792e82b32b305039d6e4662"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga343969e08d276e480a2fa3b14151f287"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__handle.html#ga74216ea6ba6c5487d5aceb46eb35f1d6">miopenStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__batchnorm.html#ga343969e08d276e480a2fa3b14151f287">miopenBatchNormalizationForwardTraining</a> (miopenHandle_t handle, <a class="el" href="group__batchnorm.html#gab21179fc753f8e0d1a6f23ac9b340a26">miopenBatchNormMode_t</a> bn_mode, void *alpha, void *beta, const miopenTensorDescriptor_t xDesc, const void *x, const miopenTensorDescriptor_t yDesc, void *y, const miopenTensorDescriptor_t bnScaleBiasMeanVarDesc, void *bnScale, void *bnBias, double expAvgFactor, void *resultRunningMean, void *resultRunningVariance, double epsilon, void *resultSaveMean, void *resultSaveInvVariance)</td></tr>
<tr class="memdesc:ga343969e08d276e480a2fa3b14151f287"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute forward training layer for batch normalization.  <a href="group__batchnorm.html#ga343969e08d276e480a2fa3b14151f287">More...</a><br /></td></tr>
<tr class="separator:ga343969e08d276e480a2fa3b14151f287"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga076386cb1c1bf692f1883c3d1a013a45"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__handle.html#ga74216ea6ba6c5487d5aceb46eb35f1d6">miopenStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__batchnorm.html#ga076386cb1c1bf692f1883c3d1a013a45">miopenBatchNormalizationForwardInference</a> (miopenHandle_t handle, <a class="el" href="group__batchnorm.html#gab21179fc753f8e0d1a6f23ac9b340a26">miopenBatchNormMode_t</a> bn_mode, void *alpha, void *beta, const miopenTensorDescriptor_t xDesc, const void *x, const miopenTensorDescriptor_t yDesc, void *y, const miopenTensorDescriptor_t bnScaleBiasMeanVarDesc, void *bnScale, void *bnBias, void *estimatedMean, void *estimatedVariance, double epsilon)</td></tr>
<tr class="memdesc:ga076386cb1c1bf692f1883c3d1a013a45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute forward inference layer for batch normalization.  <a href="group__batchnorm.html#ga076386cb1c1bf692f1883c3d1a013a45">More...</a><br /></td></tr>
<tr class="separator:ga076386cb1c1bf692f1883c3d1a013a45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaae2f39675310df613802dcf8cfd446a5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__handle.html#ga74216ea6ba6c5487d5aceb46eb35f1d6">miopenStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__batchnorm.html#gaae2f39675310df613802dcf8cfd446a5">miopenBatchNormalizationBackward</a> (miopenHandle_t handle, <a class="el" href="group__batchnorm.html#gab21179fc753f8e0d1a6f23ac9b340a26">miopenBatchNormMode_t</a> bn_mode, const void *alphaDataDiff, const void *betaDataDiff, const void *alphaParamDiff, const void *betaParamDiff, const miopenTensorDescriptor_t xDesc, const void *x, const miopenTensorDescriptor_t dyDesc, const void *dy, const miopenTensorDescriptor_t dxDesc, void *dx, const miopenTensorDescriptor_t bnScaleBiasDiffDesc, const void *bnScale, void *resultBnScaleDiff, void *resultBnBiasDiff, double epsilon, const void *savedMean, const void *savedInvVariance)</td></tr>
<tr class="memdesc:gaae2f39675310df613802dcf8cfd446a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute backwards propagation layer for batch normalization.  <a href="group__batchnorm.html#gaae2f39675310df613802dcf8cfd446a5">More...</a><br /></td></tr>
<tr class="separator:gaae2f39675310df613802dcf8cfd446a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="gab21179fc753f8e0d1a6f23ac9b340a26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab21179fc753f8e0d1a6f23ac9b340a26">&#9670;&nbsp;</a></span>miopenBatchNormMode_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__batchnorm.html#gab21179fc753f8e0d1a6f23ac9b340a26">miopenBatchNormMode_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Batch Normalization layer mode </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gab21179fc753f8e0d1a6f23ac9b340a26a44ab9eadea90a770a3744a61b71d536f"></a>miopenBNPerActivation&#160;</td><td class="fielddoc"><p>Element-wise normalization for fully connected layer </p>
</td></tr>
<tr><td class="fieldname"><a id="gab21179fc753f8e0d1a6f23ac9b340a26a42ebad7a4f774e7dc3df2de80b31a3e0"></a>miopenBNSpatial&#160;</td><td class="fielddoc"><p>Mini-batch spatial normalization for convolutional layers </p>
</td></tr>
</table>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2ldelaney_2_m_i_open_2include_2miopen_2miopen_8h-example.html#a81">/home/ldelaney/MIOpen/include/miopen/miopen.h</a>.</dd>
</dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaae2f39675310df613802dcf8cfd446a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaae2f39675310df613802dcf8cfd446a5">&#9670;&nbsp;</a></span>miopenBatchNormalizationBackward()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__handle.html#ga74216ea6ba6c5487d5aceb46eb35f1d6">miopenStatus_t</a> miopenBatchNormalizationBackward </td>
          <td>(</td>
          <td class="paramtype">miopenHandle_t&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__batchnorm.html#gab21179fc753f8e0d1a6f23ac9b340a26">miopenBatchNormMode_t</a>&#160;</td>
          <td class="paramname"><em>bn_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>alphaDataDiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>betaDataDiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>alphaParamDiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>betaParamDiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const miopenTensorDescriptor_t&#160;</td>
          <td class="paramname"><em>xDesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const miopenTensorDescriptor_t&#160;</td>
          <td class="paramname"><em>dyDesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const miopenTensorDescriptor_t&#160;</td>
          <td class="paramname"><em>dxDesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const miopenTensorDescriptor_t&#160;</td>
          <td class="paramname"><em>bnScaleBiasDiffDesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>bnScale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>resultBnScaleDiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>resultBnBiasDiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>epsilon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>savedMean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>savedInvVariance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Execute backwards propagation layer for batch normalization. </p>
<p>Batch normalization pass for backwards propagation training pass. The method for backwards propagation batch normalization.</p>
<p>Takes in batch normalization mode bn_mode and input tensor data x, input activation tensor dy, output tensor dx, the learned tensors resultBNBiasDiff and resultBNScaleDiff with their descriptor.</p>
<p>If BOTH savedMean, and savedVariance are not null pointers then the method will use the saved mean and variance calculated by the forward training phase.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>MIOpen handle (input) </td></tr>
    <tr><td class="paramname">bn_mode</td><td>Batch normalization mode (input) </td></tr>
    <tr><td class="paramname">alphaDataDiff</td><td>Floating point scaling factor, allocated on the host (input) </td></tr>
    <tr><td class="paramname">betaDataDiff</td><td>Floating point shift factor, allocated on the host (input) </td></tr>
    <tr><td class="paramname">alphaParamDiff</td><td>Floating point scaling factor, allocated on the host (input) </td></tr>
    <tr><td class="paramname">betaParamDiff</td><td>Floating point shift factor, allocated on the host (input) </td></tr>
    <tr><td class="paramname">xDesc</td><td>Tensor descriptor for data input tensor x (input) </td></tr>
    <tr><td class="paramname">x</td><td>Data tensor x (input) </td></tr>
    <tr><td class="paramname">dyDesc</td><td>Tensor descriptor for output data tensor y (input) </td></tr>
    <tr><td class="paramname">dy</td><td>Data tensor y (input) </td></tr>
    <tr><td class="paramname">dxDesc</td><td>Tensor descriptor for output data tensor dx (input) </td></tr>
    <tr><td class="paramname">dx</td><td>Data delta tensor dx (output) </td></tr>
    <tr><td class="paramname">bnScaleBiasDiffDesc</td><td>Tensor descriptor for BN scaling, shifting, saved variance and mean (input) </td></tr>
    <tr><td class="paramname">bnScale</td><td>Batch norm scaling, gamma, tensor (input) </td></tr>
    <tr><td class="paramname">resultBnScaleDiff</td><td>Tensor for dscale (output) </td></tr>
    <tr><td class="paramname">resultBnBiasDiff</td><td>Tensor for dbias (output) </td></tr>
    <tr><td class="paramname">epsilon</td><td>Value to stabilize inverse variance calculation (input) </td></tr>
    <tr><td class="paramname">savedMean</td><td>Saved mini-batch mean for backwards pass (input) </td></tr>
    <tr><td class="paramname">savedInvVariance</td><td>Saved mini-bathc inverse variance for backwards pass (input) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>miopenStatus_t </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2ldelaney_2_m_i_open_2include_2miopen_2miopen_8h-example.html#a236">/home/ldelaney/MIOpen/include/miopen/miopen.h</a>.</dd>
</dl>

</div>
</div>
<a id="ga076386cb1c1bf692f1883c3d1a013a45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga076386cb1c1bf692f1883c3d1a013a45">&#9670;&nbsp;</a></span>miopenBatchNormalizationForwardInference()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__handle.html#ga74216ea6ba6c5487d5aceb46eb35f1d6">miopenStatus_t</a> miopenBatchNormalizationForwardInference </td>
          <td>(</td>
          <td class="paramtype">miopenHandle_t&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__batchnorm.html#gab21179fc753f8e0d1a6f23ac9b340a26">miopenBatchNormMode_t</a>&#160;</td>
          <td class="paramname"><em>bn_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const miopenTensorDescriptor_t&#160;</td>
          <td class="paramname"><em>xDesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const miopenTensorDescriptor_t&#160;</td>
          <td class="paramname"><em>yDesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const miopenTensorDescriptor_t&#160;</td>
          <td class="paramname"><em>bnScaleBiasMeanVarDesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>bnScale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>bnBias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>estimatedMean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>estimatedVariance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>epsilon</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Execute forward inference layer for batch normalization. </p>
<p>Batch normalization pass for forward inference pass. Takes in batch normalization mode bn_mode and input tensor x, output tensor y, bnBias and bnScale with their descriptor.</p>
<p>If either estimatedMean, or estimatedVariance are null pointers then the values for the mean and variance will be calculated from input data and this calculated mean and variance will be used to update input values. If variance is zero and epsilon is also zero, this function outputs NAN values. Input espilon value should always be non zero positive value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>MIOpen handle (input) </td></tr>
    <tr><td class="paramname">bn_mode</td><td>Batch normalization mode (input) </td></tr>
    <tr><td class="paramname">alpha</td><td>Floating point scaling factor, allocated on the host (input) </td></tr>
    <tr><td class="paramname">beta</td><td>Floating point shift factor, allocated on the host (input) </td></tr>
    <tr><td class="paramname">xDesc</td><td>Tensor descriptor for data input tensor x (input) </td></tr>
    <tr><td class="paramname">x</td><td>Data tensor x (input) </td></tr>
    <tr><td class="paramname">yDesc</td><td>Tensor descriptor for output data tensor y (input) </td></tr>
    <tr><td class="paramname">y</td><td>Data tensor y (output) </td></tr>
    <tr><td class="paramname">bnScaleBiasMeanVarDesc</td><td>Tensor descriptor for BN scaling, shifting, saved variance and mean (input) </td></tr>
    <tr><td class="paramname">bnScale</td><td>Batch norm scaling, gamma, tensor (input) </td></tr>
    <tr><td class="paramname">bnBias</td><td>Batch norm bias, beta, tensor (input) </td></tr>
    <tr><td class="paramname">estimatedMean</td><td>Running average saved during forward training (input) </td></tr>
    <tr><td class="paramname">estimatedVariance</td><td>Running variance saved during forward training (input) </td></tr>
    <tr><td class="paramname">epsilon</td><td>Value to stabilize inverse variance calculation (input) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>miopenStatus_t </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2ldelaney_2_m_i_open_2include_2miopen_2miopen_8h-example.html#a235">/home/ldelaney/MIOpen/include/miopen/miopen.h</a>.</dd>
</dl>

</div>
</div>
<a id="ga343969e08d276e480a2fa3b14151f287"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga343969e08d276e480a2fa3b14151f287">&#9670;&nbsp;</a></span>miopenBatchNormalizationForwardTraining()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__handle.html#ga74216ea6ba6c5487d5aceb46eb35f1d6">miopenStatus_t</a> miopenBatchNormalizationForwardTraining </td>
          <td>(</td>
          <td class="paramtype">miopenHandle_t&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__batchnorm.html#gab21179fc753f8e0d1a6f23ac9b340a26">miopenBatchNormMode_t</a>&#160;</td>
          <td class="paramname"><em>bn_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const miopenTensorDescriptor_t&#160;</td>
          <td class="paramname"><em>xDesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const miopenTensorDescriptor_t&#160;</td>
          <td class="paramname"><em>yDesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const miopenTensorDescriptor_t&#160;</td>
          <td class="paramname"><em>bnScaleBiasMeanVarDesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>bnScale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>bnBias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>expAvgFactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>resultRunningMean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>resultRunningVariance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>epsilon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>resultSaveMean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>resultSaveInvVariance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Execute forward training layer for batch normalization. </p>
<p>Batch normalization pass for forward training pass. Takes in batch normalization mode bn_mode and input tensor x, output tensor y, bnBias and bnScale with their descriptor.</p>
<p>If either resultSaveMean, or resultSaveInvVariance are null pointers then the values for the mean and inverse variance will not be used.</p>
<p>Likewise, if either resultRunningMean, or resultRunningVariance are null pointers then the values for the running mean and variance will not be saved. Running averages and variances are scaled using an exponential averaging factor: </p><p class="formulaDsp">
\[ \mu_{old} = \mu_{new}*factor + \mu_{old}*(1-factor) \]
</p>
<p> where </p><p class="formulaDsp">
\[ factor=1/(1+iteration) \]
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>MIOpen handle (input) </td></tr>
    <tr><td class="paramname">bn_mode</td><td>Batch normalization mode (input) </td></tr>
    <tr><td class="paramname">alpha</td><td>Floating point scaling factor, allocated on the host (input) </td></tr>
    <tr><td class="paramname">beta</td><td>Floating point shift factor, allocated on the host (input) </td></tr>
    <tr><td class="paramname">xDesc</td><td>Tensor descriptor for data input tensor x (input) </td></tr>
    <tr><td class="paramname">x</td><td>Data tensor x (input) </td></tr>
    <tr><td class="paramname">yDesc</td><td>Tensor descriptor for output data tensor y (input) </td></tr>
    <tr><td class="paramname">y</td><td>Data tensor y (output) </td></tr>
    <tr><td class="paramname">bnScaleBiasMeanVarDesc</td><td>Tensor descriptor for BN scaling, shifting, saved variance and mean (input) </td></tr>
    <tr><td class="paramname">bnScale</td><td>Batch norm scaling, gamma, tensor (input) </td></tr>
    <tr><td class="paramname">bnBias</td><td>Batch norm bias, beta, tensor (input) </td></tr>
    <tr><td class="paramname">expAvgFactor</td><td>Exponential averaging factor (input) </td></tr>
    <tr><td class="paramname">resultRunningMean</td><td>Running average saved for inference (output) </td></tr>
    <tr><td class="paramname">resultRunningVariance</td><td>Running variance saved for inference (output) </td></tr>
    <tr><td class="paramname">epsilon</td><td>Value to stablize inverse variance calculation (input) </td></tr>
    <tr><td class="paramname">resultSaveMean</td><td>Saved mini-batch mean for backwards pass (output) </td></tr>
    <tr><td class="paramname">resultSaveInvVariance</td><td>Saved mini-batch inverse variance for backwards pass (output) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>miopenStatus_t </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2ldelaney_2_m_i_open_2include_2miopen_2miopen_8h-example.html#a234">/home/ldelaney/MIOpen/include/miopen/miopen.h</a>.</dd>
</dl>

</div>
</div>
<a id="gaf2aef2cbd792e82b32b305039d6e4662"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf2aef2cbd792e82b32b305039d6e4662">&#9670;&nbsp;</a></span>miopenDeriveBNTensorDescriptor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__handle.html#ga74216ea6ba6c5487d5aceb46eb35f1d6">miopenStatus_t</a> miopenDeriveBNTensorDescriptor </td>
          <td>(</td>
          <td class="paramtype">miopenTensorDescriptor_t&#160;</td>
          <td class="paramname"><em>derivedBnDesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const miopenTensorDescriptor_t&#160;</td>
          <td class="paramname"><em>xDesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__batchnorm.html#gab21179fc753f8e0d1a6f23ac9b340a26">miopenBatchNormMode_t</a>&#160;</td>
          <td class="paramname"><em>bn_mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Derive tensor for gamma and beta from input tensor descriptor. </p>
<p>This function takes the input tensor descriptor and outputs a derived tensor for the normalization scale (gamma) and shift (beta) tensors.</p>
<p>For an input tensor NCHW and spatial mode, the output derived tensor is 1C11, while for per-activation the derived tensor is 1CHW.</p>
<p>For an input tensor NCDHW and spatial mode, the output derived tensor is 1C111, while for per-activation the derived tensor is 1CDHW.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">derivedBnDesc</td><td>Output derived tensor descriptor (output) </td></tr>
    <tr><td class="paramname">xDesc</td><td>Input tensor descriptor (input) </td></tr>
    <tr><td class="paramname">bn_mode</td><td>Batch Normalization mode (input) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>miopenStatus_t </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="_2home_2ldelaney_2_m_i_open_2include_2miopen_2miopen_8h-example.html#a233">/home/ldelaney/MIOpen/include/miopen/miopen.h</a>.</dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
