

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Find and Immediate Mode &mdash; MIOpen: AMD&#39;s deep learning library</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Fusion API: Getting Started" href="Getting_Started_FusionAPI.html" />
    <link rel="prev" title="Find-Db Database" href="finddb.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> MIOpen
          

          
          </a>

          
            
            
              <div class="version">
                2.7.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="releasenotes.html">MIOpen Release notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">09/14/2020 [ 2.7.0 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">08/20/2020 [ 2.6.0 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">07/10/2020 [ 2.5.0 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">06/02/2020 [ 2.4.0 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">03/01/2020 [ 2.3.0 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">01/24/2020 [ 2.2.1 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">12/19/2019 [ 2.2.0 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">09/25/2019 [ 2.1.0 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">08/13/2019 [ 2.0.1 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">07/08/2019 [ 2.0.0 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">05/03/2019 [ 1.8.1 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">04/11/2019 [ 1.8.0 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">02/06/2019 [ 1.7.1 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">12/19/2018 [ 1.7.0 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">11/18/2018 [ 1.6.0 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">09/14/2018 [ 1.5.0 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">07/30/2018 [ 1.4.2 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">07/19/2018 [ 1.4.1 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">07/06/2018 [ 1.4.0 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">03/30/2018 [ 1.3.0 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">03/08/2018 [ 1.2.1 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">12/15/2017 [ 1.2.0 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">09/08/2017 [ 1.1.0 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">08/27/2017 [ 1.0.2 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#">07/26/2017 [ 1.0.1 ]</a></li>
<li class="toctree-l2"><a class="reference internal" href="releasenotes.html#initial-release">06/30/2017 [ 1.0.0 ] Initial release</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">Citing MIOpen</a><ul>
<li class="toctree-l2"><a class="reference internal" href="citation.html#citation-bibtex">Citation BibTeX</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Build and Install Instructions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#installing-miopen-with-pre-built-packages">Installing MIOpen with pre-built packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#installing-miopen-kernels-package">Installing MIOpen kernels package</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#installing-the-dependencies">Installing the dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#installing-minimum-dependencies-in-rocm-environment">Installing minimum dependencies in ROCm environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#building-miopen-from-source">Building MIOpen from source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="install.html#configuring-with-cmake">Configuring with cmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html#for-opencl-run">For OpenCL, run:</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html#for-the-hip-backend-on-rocm-3-3-and-earlier-run">For the HIP backend on ROCm 3.3 and earlier, run:</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html#for-the-hip-backend-on-rocm-3-5-and-later-run">For the HIP backend on ROCm 3.5 and later, run:</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html#setting-up-locations">Setting Up Locations</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html#system-performance-database-and-user-database">System Performance Database and User Database</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html#persistent-program-cache">Persistent Program Cache</a><ul>
<li class="toctree-l4"><a class="reference internal" href="install.html#for-miopen-version-2-3-and-earlier">For MIOpen version 2.3 and earlier</a></li>
<li class="toctree-l4"><a class="reference internal" href="install.html#for-miopen-version-2-4-and-later">For MIOpen version 2.4 and later</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="install.html#changing-the-cmake-configuration">Changing the cmake configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="install.html#building-the-library">Building the library</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#building-the-driver">Building the driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#running-the-tests">Running the tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#building-the-documentation">Building the documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#formatting-the-code">Formatting the code</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#installing-the-dependencies-manually">Installing the dependencies manually</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#using-docker">Using docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#citing-miopen">Citing MIOpen</a><ul>
<li class="toctree-l3"><a class="reference internal" href="install.html#citation-bibtex">Citation BibTeX</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="driver.html">MIOpenDriver</a><ul>
<li class="toctree-l2"><a class="reference internal" href="driver.html#building-the-driver">Building the Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="driver.html#base-arguments">Base Arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="driver.html#executing-miopendriver">Executing MIOpenDriver</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="DebugAndLogging.html">Debugging and Logging</a><ul>
<li class="toctree-l2"><a class="reference internal" href="DebugAndLogging.html#logging">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="DebugAndLogging.html#layer-filtering">Layer Filtering</a><ul>
<li class="toctree-l3"><a class="reference internal" href="DebugAndLogging.html#filtering-by-algorithm">Filtering by algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="DebugAndLogging.html#filtering-by-build-method">Filtering by build method</a></li>
<li class="toctree-l3"><a class="reference internal" href="DebugAndLogging.html#filtering-out-all-solutions-except-one">Filtering out all Solutions except one</a></li>
<li class="toctree-l3"><a class="reference internal" href="DebugAndLogging.html#filtering-the-solutions-on-individual-basis">Filtering the Solutions on individual basis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="DebugAndLogging.html#rocblas-logging-and-behavior">rocBlas Logging and Behavior</a></li>
<li class="toctree-l2"><a class="reference internal" href="DebugAndLogging.html#numerical-checking">Numerical Checking</a></li>
<li class="toctree-l2"><a class="reference internal" href="DebugAndLogging.html#controlling-parallel-compilation">Controlling Parallel Compilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="DebugAndLogging.html#experimental-controls">Experimental controls</a><ul>
<li class="toctree-l3"><a class="reference internal" href="DebugAndLogging.html#code-object-co-version-selection-experimental">Code Object (CO) version selection (EXPERIMENTAL)</a></li>
<li class="toctree-l3"><a class="reference internal" href="DebugAndLogging.html#winograd-multi-pass-maximum-workspace-throttling">Winograd Multi-pass Maximum Workspace throttling</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cache.html">Kernel Cache</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cache.html#clear-the-cache">Clear the cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="cache.html#disabling-the-cache">Disabling the cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="cache.html#updating-miopen-and-removing-the-cache">Updating MIOpen and removing the cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="cache.html#installing-pre-compiled-kernels">Installing pre-compiled kernels</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="perfdatabase.html">Performance Database</a><ul>
<li class="toctree-l2"><a class="reference internal" href="perfdatabase.html#auto-tuning-the-kernels">Auto-tuning the kernels.</a><ul>
<li class="toctree-l3"><a class="reference internal" href="perfdatabase.html#miopen-find-enforce">MIOPEN_FIND_ENFORCE</a></li>
<li class="toctree-l3"><a class="reference internal" href="perfdatabase.html#miopen-find-enforce-scope">MIOPEN_FIND_ENFORCE_SCOPE</a></li>
<li class="toctree-l3"><a class="reference internal" href="perfdatabase.html#updating-miopen-and-the-user-db">Updating MIOpen and the User Db</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="finddb.html">Find-Db Database</a><ul>
<li class="toctree-l2"><a class="reference internal" href="finddb.html#populating-the-user-find-db">Populating the User Find-Db</a></li>
<li class="toctree-l2"><a class="reference internal" href="finddb.html#updating-miopen-and-the-user-find-db">Updating MIOpen and the User Find-Db</a></li>
<li class="toctree-l2"><a class="reference internal" href="finddb.html#disabling-find-db">Disabling Find-Db</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Find and Immediate Mode</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#find-api">Find API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#immediate-mode-api">Immediate Mode API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#immediate-mode-fall-back">Immediate Mode Fall Back</a></li>
<li class="toctree-l2"><a class="reference internal" href="#limitations-of-immediate-mode">Limitations of Immediate Mode</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#architectual-limitations">Architectual Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#backend-limitations">Backend Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#find-modes">Find Modes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Getting_Started_FusionAPI.html">Fusion API: Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Getting_Started_FusionAPI.html#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Getting_Started_FusionAPI.html#intended-audience">Intended Audience</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Getting_Started_FusionAPI.html#create-a-fusion-plan">Create a Fusion Plan</a></li>
<li class="toctree-l2"><a class="reference internal" href="Getting_Started_FusionAPI.html#create-and-add-operators">Create and add Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="Getting_Started_FusionAPI.html#compile-the-fusion-plan">Compile the Fusion Plan</a></li>
<li class="toctree-l2"><a class="reference internal" href="Getting_Started_FusionAPI.html#set-the-runtime-arguments">Set the runtime arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="Getting_Started_FusionAPI.html#execute-a-fusion-plan">Execute a Fusion Plan</a></li>
<li class="toctree-l2"><a class="reference internal" href="Getting_Started_FusionAPI.html#cleanup">Cleanup</a></li>
<li class="toctree-l2"><a class="reference internal" href="Getting_Started_FusionAPI.html#supported-fusions">Supported Fusions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Getting_Started_FusionAPI.html#performance-comparison-to-non-fused-kernels">Performance Comparison to Non-Fused Kernels</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="apireference.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="datatypes.html">Datatypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="handle.html">Handle</a><ul>
<li class="toctree-l3"><a class="reference internal" href="handle.html#miopenstatus-t">miopenStatus_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="handle.html#miopencreate">miopenCreate</a></li>
<li class="toctree-l3"><a class="reference internal" href="handle.html#miopencreatewithstream">miopenCreateWithStream</a></li>
<li class="toctree-l3"><a class="reference internal" href="handle.html#miopendestroy">miopenDestroy</a></li>
<li class="toctree-l3"><a class="reference internal" href="handle.html#miopensetstream">miopenSetStream</a></li>
<li class="toctree-l3"><a class="reference internal" href="handle.html#miopengetstream">miopenGetStream</a></li>
<li class="toctree-l3"><a class="reference internal" href="handle.html#miopengetkerneltime">miopenGetKernelTime</a></li>
<li class="toctree-l3"><a class="reference internal" href="handle.html#miopenenableprofiling">miopenEnableProfiling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tensor.html">Tensors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tensor.html#miopendatatype-t">miopenDataType_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="tensor.html#miopentensorop-t">miopenTensorOp_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="tensor.html#miopencreatetensordescriptor">miopenCreateTensorDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="tensor.html#miopenset4dtensordescriptor">miopenSet4dTensorDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="tensor.html#miopenget4dtensordescriptor">miopenGet4dTensorDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="tensor.html#miopensettensordescriptor">miopenSetTensorDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="tensor.html#miopengettensordescriptorsize">miopenGetTensorDescriptorSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="tensor.html#miopengettensordescriptor">miopenGetTensorDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="tensor.html#miopendestroytensordescriptor">miopenDestroyTensorDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="tensor.html#miopenoptensor">miopenOpTensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="tensor.html#miopensettensor">miopenSetTensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="tensor.html#miopenscaletensor">miopenScaleTensor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="activation.html">Activation Layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="activation.html#miopenactivationmode-t">miopenActivationMode_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="activation.html#miopencreateactivationdescriptor">miopenCreateActivationDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="activation.html#miopensetactivationdescriptor">miopenSetActivationDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="activation.html#miopengetactivationdescriptor">miopenGetActivationDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="activation.html#miopenactivationforward">miopenActivationForward</a></li>
<li class="toctree-l3"><a class="reference internal" href="activation.html#miopenactivationbackward">miopenActivationBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="activation.html#miopendestroyactivationdescriptor">miopenDestroyActivationDescriptor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="convolution.html">Convolutional Layer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopenconvolutionmode-t">miopenConvolutionMode_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopenconvfwdalgorithm-t">miopenConvFwdAlgorithm_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopenconvbwdweightsalgorithm-t">miopenConvBwdWeightsAlgorithm_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopenconvbwddataalgorithm-t">miopenConvBwdDataAlgorithm_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopenconvalgoperf-t">miopenConvAlgoPerf_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopenconvsolution-t">miopenConvSolution_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopencreateconvolutiondescriptor">miopenCreateConvolutionDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopeninitconvolutiondescriptor">miopenInitConvolutionDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopeninitconvolutionnddescriptor">miopenInitConvolutionNdDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopengetconvolutiondescriptor">miopenGetConvolutionDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopengetconvolutionnddescriptor">miopenGetConvolutionNdDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopensetconvolutiongroupcount">miopenSetConvolutionGroupCount</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopensettransposeconvoutputpadding">miopenSetTransposeConvOutputPadding</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopensettransposeconvndoutputpadding">miopenSetTransposeConvNdOutputPadding</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopengetconvolutionforwardoutputdim">miopenGetConvolutionForwardOutputDim</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopengetconvolutionndforwardoutputdim">miopenGetConvolutionNdForwardOutputDim</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopenconvolutionforwardgetworkspacesize">miopenConvolutionForwardGetWorkSpaceSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopenfindconvolutionforwardalgorithm">miopenFindConvolutionForwardAlgorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopenconvolutionforward">miopenConvolutionForward</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopenconvolutionforwardbias">miopenConvolutionForwardBias</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopenfindconvolutionbackwarddataalgorithm">miopenFindConvolutionBackwardDataAlgorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopenconvolutionbackwarddata">miopenConvolutionBackwardData</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopenconvolutionbackwarddatagetworkspacesize">miopenConvolutionBackwardDataGetWorkSpaceSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopenconvolutionbackwardweightsgetworkspacesize">miopenConvolutionBackwardWeightsGetWorkSpaceSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopenfindconvolutionbackwardweightsalgorithm">miopenFindConvolutionBackwardWeightsAlgorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopenconvolutionbackwardweights">miopenConvolutionBackwardWeights</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopenconvolutionbackwardbias">miopenConvolutionBackwardBias</a></li>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#miopendestroyconvolutiondescriptor">miopenDestroyConvolutionDescriptor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="rnn.html">Recurrent Neural Networks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopenrnnmode-t">miopenRNNMode_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopenrnninputmode-t">miopenRNNInputMode_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopenrnnalgo-t">miopenRNNAlgo_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopenrnndirectionmode-t">miopenRNNDirectionMode_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopenrnnbiasmode-t">miopenRNNBiasMode_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopenrnngemmalgomode-t">miopenRNNGEMMalgoMode_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopencreaternndescriptor">miopenCreateRNNDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopengetrnndescriptor">miopenGetRNNDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopengetrnndescriptor-v2">miopenGetRNNDescriptor_V2</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopendestroyrnndescriptor">miopenDestroyRNNDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopensetrnndescriptor">miopenSetRNNDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopensetrnndescriptor-v2">miopenSetRNNDescriptor_V2</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopengetrnnworkspacesize">miopenGetRNNWorkspaceSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopengetrnntrainingreservesize">miopenGetRNNTrainingReserveSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopengetrnnparamssize">miopenGetRNNParamsSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopengetrnnparamsdescriptor">miopenGetRNNParamsDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopengetrnninputtensorsize">miopenGetRNNInputTensorSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopengetrnnhiddentensorsize">miopenGetRNNHiddenTensorSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopengetrnnlayerparamsize">miopenGetRNNLayerParamSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopengetrnnlayerbiassize">miopenGetRNNLayerBiasSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopengetrnnlayerparam">miopenGetRNNLayerParam</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopengetrnnlayerbias">miopenGetRNNLayerBias</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopensetrnnlayerparam">miopenSetRNNLayerParam</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopensetrnnlayerbias">miopenSetRNNLayerBias</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopengetrnnlayerparamoffset">miopenGetRNNLayerParamOffset</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopengetrnnlayerbiasoffset">miopenGetRNNLayerBiasOffset</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopenrnnforwardtraining">miopenRNNForwardTraining</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopenrnnbackwarddata">miopenRNNBackwardData</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopenrnnbackwardweights">miopenRNNBackwardWeights</a></li>
<li class="toctree-l3"><a class="reference internal" href="rnn.html#miopenrnnforwardinference">miopenRNNForwardInference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="batchnorm.html">Batch Normalization Layer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="batchnorm.html#miopenbatchnormmode-t">miopenBatchNormMode_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="batchnorm.html#miopenderivebntensordescriptor">miopenDeriveBNTensorDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="batchnorm.html#miopenbatchnormalizationforwardtraining">miopenBatchNormalizationForwardTraining</a></li>
<li class="toctree-l3"><a class="reference internal" href="batchnorm.html#miopenbatchnormalizationforwardinference">miopenBatchNormalizationForwardInference</a></li>
<li class="toctree-l3"><a class="reference internal" href="batchnorm.html#miopenbatchnormalizationbackward">miopenBatchNormalizationBackward</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lrn.html">Local Response Normalization Layer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lrn.html#miopenlrnmode-t">miopenLRNMode_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="lrn.html#miopencreatelrndescriptor">miopenCreateLRNDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="lrn.html#miopensetlrndescriptor">miopenSetLRNDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="lrn.html#miopengetlrndescriptor">miopenGetLRNDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="lrn.html#miopenlrngetworkspacesize">miopenLRNGetWorkSpaceSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="lrn.html#miopenlrnforward">miopenLRNForward</a></li>
<li class="toctree-l3"><a class="reference internal" href="lrn.html#miopenlrnbackward">miopenLRNBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="lrn.html#miopendestroylrndescriptor">miopenDestroyLRNDescriptor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pooling.html">Pooling Layer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pooling.html#miopenpoolingmode-t">miopenPoolingMode_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="pooling.html#miopenindextype-t">miopenIndexType_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="pooling.html#miopencreatepoolingdescriptor">miopenCreatePoolingDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="pooling.html#miopenset2dpoolingdescriptor">miopenSet2dPoolingDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="pooling.html#miopensetndpoolingdescriptor">miopenSetNdPoolingDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="pooling.html#miopensetpoolingindextype">miopenSetPoolingIndexType</a></li>
<li class="toctree-l3"><a class="reference internal" href="pooling.html#miopengetpoolingindextype">miopenGetPoolingIndexType</a></li>
<li class="toctree-l3"><a class="reference internal" href="pooling.html#miopenget2dpoolingdescriptor">miopenGet2dPoolingDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="pooling.html#miopengetndpoolingdescriptor">miopenGetNdPoolingDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="pooling.html#miopengetpoolingforwardoutputdim">miopenGetPoolingForwardOutputDim</a></li>
<li class="toctree-l3"><a class="reference internal" href="pooling.html#miopengetpoolingndforwardoutputdim">miopenGetPoolingNdForwardOutputDim</a></li>
<li class="toctree-l3"><a class="reference internal" href="pooling.html#miopenpoolinggetworkspacesize">miopenPoolingGetWorkSpaceSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="pooling.html#miopenpoolinggetworkspacesizev2">miopenPoolingGetWorkSpaceSizeV2</a></li>
<li class="toctree-l3"><a class="reference internal" href="pooling.html#miopenpoolingforward">miopenPoolingForward</a></li>
<li class="toctree-l3"><a class="reference internal" href="pooling.html#miopenpoolingbackward">miopenPoolingBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="pooling.html#miopendestroypoolingdescriptor">miopenDestroyPoolingDescriptor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="softmax.html">Softmax Layer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="softmax.html#miopensoftmaxalgorithm-t">miopenSoftmaxAlgorithm_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="softmax.html#miopensoftmaxmode-t">miopenSoftmaxMode_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="softmax.html#miopensoftmaxforward">miopenSoftmaxForward</a></li>
<li class="toctree-l3"><a class="reference internal" href="softmax.html#miopensoftmaxbackward">miopenSoftmaxBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="softmax.html#miopensoftmaxforward-v2">miopenSoftmaxForward_V2</a></li>
<li class="toctree-l3"><a class="reference internal" href="softmax.html#miopensoftmaxbackward-v2">miopenSoftmaxBackward_V2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="fusion.html">Layer Fusion</a><ul>
<li class="toctree-l3"><a class="reference internal" href="fusion.html#miopenfusiondirection-t">miopenFusionDirection_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="fusion.html#miopencreatefusionplan">miopenCreateFusionPlan</a></li>
<li class="toctree-l3"><a class="reference internal" href="fusion.html#miopendestroyfusionplan">miopenDestroyFusionPlan</a></li>
<li class="toctree-l3"><a class="reference internal" href="fusion.html#miopencompilefusionplan">miopenCompileFusionPlan</a></li>
<li class="toctree-l3"><a class="reference internal" href="fusion.html#miopenfusionplangetop">miopenFusionPlanGetOp</a></li>
<li class="toctree-l3"><a class="reference internal" href="fusion.html#miopenfusionplangetworkspacesize">miopenFusionPlanGetWorkSpaceSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="fusion.html#miopenfusionplanconvolutiongetalgo">miopenFusionPlanConvolutionGetAlgo</a></li>
<li class="toctree-l3"><a class="reference internal" href="fusion.html#miopencreateopconvforward">miopenCreateOpConvForward</a></li>
<li class="toctree-l3"><a class="reference internal" href="fusion.html#miopencreateopactivationforward">miopenCreateOpActivationForward</a></li>
<li class="toctree-l3"><a class="reference internal" href="fusion.html#miopencreateopbiasforward">miopenCreateOpBiasForward</a></li>
<li class="toctree-l3"><a class="reference internal" href="fusion.html#miopencreateopbatchnorminference">miopenCreateOpBatchNormInference</a></li>
<li class="toctree-l3"><a class="reference internal" href="fusion.html#miopencreateoperatorargs">miopenCreateOperatorArgs</a></li>
<li class="toctree-l3"><a class="reference internal" href="fusion.html#miopendestroyoperatorargs">miopenDestroyOperatorArgs</a></li>
<li class="toctree-l3"><a class="reference internal" href="fusion.html#miopensetopargsconvforward">miopenSetOpArgsConvForward</a></li>
<li class="toctree-l3"><a class="reference internal" href="fusion.html#miopensetopargsbatchnorminference">miopenSetOpArgsBatchNormInference</a></li>
<li class="toctree-l3"><a class="reference internal" href="fusion.html#miopensetopargsbiasforward">miopenSetOpArgsBiasForward</a></li>
<li class="toctree-l3"><a class="reference internal" href="fusion.html#miopenexecutefusionplan">miopenExecuteFusionPlan</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="loss.html">Loss Function Layer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="loss.html#miopenctclossalgo-t">miopenCTCLossAlgo_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="loss.html#miopencreatectclossdescriptor">miopenCreateCTCLossDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="loss.html#miopengetctclossdescriptor">miopenGetCTCLossDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="loss.html#miopendestroyctclossdescriptor">miopenDestroyCTCLossDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="loss.html#miopensetctclossdescriptor">miopenSetCTCLossDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="loss.html#miopengetctclossworkspacesize">miopenGetCTCLossWorkspaceSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="loss.html#miopenctcloss">miopenCTCLoss</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dropout.html">Dropout Layer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dropout.html#miopenrngtype-t">miopenRNGType_t</a></li>
<li class="toctree-l3"><a class="reference internal" href="dropout.html#miopencreatedropoutdescriptor">miopenCreateDropoutDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="dropout.html#miopengetdropoutdescriptor">miopenGetDropoutDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="dropout.html#miopenrestoredropoutdescriptor">miopenRestoreDropoutDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="dropout.html#miopendestroydropoutdescriptor">miopenDestroyDropoutDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="dropout.html#miopensetdropoutdescriptor">miopenSetDropoutDescriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="dropout.html#miopendropoutgetreservespacesize">miopenDropoutGetReserveSpaceSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="dropout.html#miopendropoutgetstatessize">miopenDropoutGetStatesSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="dropout.html#miopendropoutforward">miopenDropoutForward</a></li>
<li class="toctree-l3"><a class="reference internal" href="dropout.html#miopendropoutbackward">miopenDropoutBackward</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MIOpen</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Find and Immediate Mode</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/find_and_immediate.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="find-and-immediate-mode">
<span id="find-and-immediate-mode"></span><h1>Find and Immediate Mode<a class="headerlink" href="#find-and-immediate-mode" title="Permalink to this headline">¶</a></h1>
<div class="section" id="find-api">
<span id="find-api"></span><h2>Find API<a class="headerlink" href="#find-api" title="Permalink to this headline">¶</a></h2>
<p>MIOpen contains several convolution algorithms for each stage of training or inference. Pre-MIOpen version 2.0 users needed to call Find methods in order generate a set of applicable algorithms.</p>
<p>A typical workflow for the find stage:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">miopenConvolutionForwardGetWorkSpaceSize</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> 
                                         <span class="n">weightTensorDesc</span><span class="p">,</span> 
                                         <span class="n">inputTensorDesc</span><span class="p">,</span> 
                                         <span class="n">convDesc</span><span class="p">,</span> 
                                         <span class="n">outputTensorDesc</span><span class="p">,</span> 
                                         <span class="o">&amp;</span><span class="n">maxWorkSpaceSize</span><span class="p">);</span>

<span class="o">//</span> <span class="o">&lt;</span> <span class="n">allocate</span> <span class="n">workspace</span> <span class="o">&gt;</span>


<span class="o">//</span> <span class="n">NOTE</span><span class="p">:</span>
<span class="o">//</span> <span class="n">miopenFindConvolution</span><span class="o">*</span><span class="p">()</span> <span class="n">call</span> <span class="ow">is</span> <span class="n">expensive</span> <span class="ow">in</span> <span class="n">terms</span> <span class="n">of</span> <span class="n">execution</span> <span class="n">time</span> <span class="ow">and</span> <span class="n">required</span> <span class="n">workspace</span><span class="o">.</span>
<span class="o">//</span> <span class="n">Therefore</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">highly</span> <span class="n">recommended</span> <span class="n">to</span> <span class="n">save</span> <span class="n">off</span> <span class="n">the</span> <span class="n">selected</span> <span class="n">algorithm</span> <span class="ow">and</span> <span class="n">workspace</span> <span class="n">required</span> <span class="n">so</span> <span class="n">that</span>
<span class="o">//</span> <span class="n">can</span> <span class="n">be</span> <span class="n">reused</span> <span class="n">later</span> <span class="n">within</span> <span class="n">the</span> <span class="n">lifetime</span> <span class="n">of</span> <span class="n">the</span> <span class="n">same</span> <span class="n">MIOpen</span> <span class="n">handle</span> <span class="nb">object</span><span class="o">.</span>
<span class="o">//</span> <span class="n">In</span> <span class="n">this</span> <span class="n">way</span><span class="p">,</span> <span class="n">there</span> <span class="n">should</span> <span class="n">be</span> <span class="ow">is</span> <span class="n">no</span> <span class="n">need</span> <span class="n">to</span> <span class="n">invoke</span> <span class="n">miopenFind</span><span class="o">*</span><span class="p">()</span> <span class="n">more</span> <span class="n">than</span> <span class="n">once</span> <span class="n">per</span> <span class="n">application</span> <span class="n">lifetime</span><span class="o">.</span>

<span class="n">miopenFindConvolutionForwardAlgorithm</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> 
                                      <span class="n">inputTensorDesc</span><span class="p">,</span> 
                                      <span class="n">input_device_mem</span><span class="p">,</span> 
                                      <span class="n">weightTensorDesc</span><span class="p">,</span> 
                                      <span class="n">weight_device_mem</span><span class="p">,</span>
                                      <span class="n">convDesc</span><span class="p">,</span>
                                      <span class="n">outputTensorDesc</span><span class="p">,</span> 
                                      <span class="n">output_device_mem</span><span class="p">,,</span>
                                      <span class="n">request_algo_count</span><span class="p">,</span>
                                      <span class="o">&amp;</span><span class="n">ret_algo_count</span><span class="p">,</span>
                                      <span class="n">perf_results</span><span class="p">,</span>
                                      <span class="n">workspace_device_mem</span><span class="p">,</span>
                                      <span class="n">maxWorkSpaceSize</span><span class="p">,</span>
                                      <span class="mi">1</span><span class="p">);</span>

<span class="o">//</span> <span class="o">&lt;</span> <span class="n">select</span> <span class="n">fastest</span> <span class="n">algorithm</span> <span class="o">&gt;</span>

<span class="o">//</span> <span class="o">&lt;</span> <span class="n">free</span> <span class="n">previously</span> <span class="n">allocated</span> <span class="n">workspace</span> <span class="ow">and</span> <span class="n">allocate</span> <span class="n">workspace</span> <span class="n">required</span> <span class="k">for</span> <span class="n">the</span> <span class="n">selected</span> <span class="n">algorithm</span><span class="o">&gt;</span>

<span class="n">miopenConvolutionForward</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">alpha</span><span class="p">,</span>
                         <span class="n">inputTensorDesc</span><span class="p">,</span> 
                         <span class="n">input_device_mem</span><span class="p">,</span> 
                         <span class="n">weightTensorDesc</span><span class="p">,</span> 
                         <span class="n">weight_device_mem</span><span class="p">,</span>
                         <span class="n">convDesc</span><span class="p">,</span>
                         <span class="n">perf_results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fwd_algo</span><span class="p">,</span> <span class="o">//</span> <span class="n">use</span> <span class="n">the</span> <span class="n">fastest</span> <span class="n">algo</span>
                         <span class="o">&amp;</span><span class="n">beta</span><span class="p">,</span>
                         <span class="n">outputTensorDesc</span><span class="p">,</span> 
                         <span class="n">output_device_mem</span><span class="p">,</span>
                         <span class="n">workspace_device_mem</span><span class="p">,</span>
                         <span class="n">perf_results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">memory</span><span class="p">);</span> <span class="o">//</span><span class="n">workspace</span> <span class="n">size</span>                                           
</pre></div>
</div>
<p>The results of Find() are returned in an array of <code class="docutils literal"><span class="pre">miopenConvAlgoPerf_t</span></code> structs in order of performance, with the fastest at index 0.</p>
<p>This call sequence is executed once per session as it is inherently expensive. Of those, <code class="docutils literal"><span class="pre">miopenFindConvolution*()</span></code> is the most expensive call. It caches its own results on disk, so the subsequent calls during the same MIOpen session will execute faster. However, it is better to remember results of <code class="docutils literal"><span class="pre">miopenFindConvolution*()</span></code> in the application, as recommended above.</p>
<p>Internally MIOpen's Find calls will compile and benchmark a set of <code class="docutils literal"><span class="pre">solvers</span></code> contained in <code class="docutils literal"><span class="pre">miopenConvAlgoPerf_t</span></code> this is done in parallel per <code class="docutils literal"><span class="pre">miopenConvAlgorithm_t</span></code>. The level of parallelism can be controlled using an environment variable. See the debugging section <a class="reference external" href="https://rocmsoftwareplatform.github.io/MIOpen/doc/html/DebugAndLogging.html#controlling-parallel-compilation">controlling parallel compilation</a> for more details.</p>
</div>
<div class="section" id="immediate-mode-api">
<span id="immediate-mode-api"></span><h2>Immediate Mode API<a class="headerlink" href="#immediate-mode-api" title="Permalink to this headline">¶</a></h2>
<p>MIOpen v2.0 introduces the immediate which removes the requirement for the <code class="docutils literal"><span class="pre">miopenFindConvolution*()</span></code> calls and their associated runtime costs. In this mode, the user can query the MIOpen runtime for all the supported <em>solutions</em> for a given convolution configuration. These solutions may either be using the same algorithm or different ones. The sequence of operations for in immediate mode is similar to launching regular convolutions in MIOpen i.e. through the use of the <code class="docutils literal"><span class="pre">miopenFindConvolution*()</span></code> API. However, in this case the different APIs have much lower runtime cost. A typical convolution call would be similar to the following sequence of calls:</p>
<ul class="simple">
<li>The user constructs the MIOpen handle and relevant descriptors such as the convolution descriptor as usual.</li>
<li>With the above data structures, the user calls <code class="docutils literal"><span class="pre">miopenConvolution*GetSolutionCount</span></code> to get the <strong>maximum</strong> number of supported solutions for the convolution descriptor in question.</li>
<li>The count obtained above is used to allocate memory for the <code class="docutils literal"><span class="pre">miopenConvSolution_t</span></code> structure introduced in MIOpen v2.0</li>
<li>The user calls <code class="docutils literal"><span class="pre">miopenConvolution*GetSolution</span></code> to populate the <code class="docutils literal"><span class="pre">miopenConvSolution_t</span></code> structures allocated above. The returned list is ordered in the order of best performance, thus the first element would be the fastest.</li>
<li>While the above structure returns the amount of workspace required for an algorithm, the user may inquire the amount of a workspace required for a known solution id by using the <code class="docutils literal"><span class="pre">miopenConvolution*GetSolutionWorkspaceSize</span></code> API call. However, this is not a requirement, since the strucure returned by <code class="docutils literal"><span class="pre">miopenConvolution*GetSolution</span></code> would already have this information.</li>
<li>Now the user may initiate the convolution operation in <em>immediate</em> mode by calling <code class="docutils literal"><span class="pre">miopenConvolution*Immediate</span></code>. Which would populate the output tensor descriptor with the respective convolution result. However, the first call to <code class="docutils literal"><span class="pre">miopenConvolution*Immediate</span></code> may consume more time since the kernel may not be present in the kernel cache and may need to be compiled.</li>
<li>Optionally, the user may compile the solution of choice by calling <code class="docutils literal"><span class="pre">miopenConvolution*CompileSolution</span></code> which would ensure that the kernel represented by the chosen solution is populated in the kernel cache a priori, removing the necessity for compiling the kernel in question.</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">miopenConvolutionForwardGetSolutionCount</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> 
                                         <span class="n">weightTensorDesc</span><span class="p">,</span>
                                         <span class="n">inputTensorDesc</span><span class="p">,</span>
                                         <span class="n">convDesc</span><span class="p">,</span>
                                         <span class="n">outputTensorDesc</span><span class="p">,</span>
                                         <span class="o">&amp;</span><span class="n">solutionCount</span><span class="p">);</span>


<span class="o">//</span> <span class="o">&lt;</span> <span class="n">allocate</span> <span class="n">an</span> <span class="n">array</span> <span class="n">of</span> <span class="n">miopenConvSolution_t</span> <span class="n">of</span> <span class="n">size</span> <span class="n">solutionCount</span> <span class="o">&gt;</span>


<span class="n">miopenConvolutionForwardGetSolution</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span>
                                    <span class="n">weightTensorDesc</span><span class="p">,</span>
                                    <span class="n">inputTensorDesc</span><span class="p">,</span>
                                    <span class="n">convDesc</span><span class="p">,</span>
                                    <span class="n">outputTensorDesc</span><span class="p">,</span>
                                    <span class="n">solutionCount</span><span class="p">,</span>
                                    <span class="o">&amp;</span><span class="n">actualCount</span><span class="p">,</span>
                                    <span class="n">solutions</span><span class="p">);</span>

<span class="o">//</span> <span class="o">&lt;</span> <span class="n">select</span> <span class="n">a</span> <span class="n">solution</span> <span class="kn">from</span> <span class="nn">solutions</span> <span class="n">array</span> <span class="o">&gt;</span>

<span class="n">miopenConvolutionForwardGetSolutionWorkspaceSize</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span>
                                                 <span class="n">weightTensorDesc</span><span class="p">,</span>
                                                 <span class="n">inputTensorDesc</span><span class="p">,</span>
                                                 <span class="n">convDesc</span><span class="p">,</span>
                                                 <span class="n">outputTensorDesc</span><span class="p">,</span>
                                                 <span class="n">selected</span><span class="o">-&gt;</span><span class="n">solution_id</span><span class="p">,</span>
                                                 <span class="o">&amp;</span><span class="n">ws_size</span><span class="p">);</span>
 
<span class="o">//</span> <span class="o">&lt;</span> <span class="n">allocate</span> <span class="n">solution</span> <span class="n">workspace</span> <span class="n">of</span> <span class="n">size</span> <span class="n">ws_size</span> <span class="o">&gt;</span>


<span class="o">//</span> <span class="n">This</span> <span class="n">stage</span> <span class="ow">is</span> <span class="n">optional</span>
<span class="n">miopenConvolutionForwardCompileSolution</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span>  
                                        <span class="n">weightTensorDesc</span><span class="p">,</span>
                                        <span class="n">inputTensorDesc</span><span class="p">,</span>
                                        <span class="n">convDesc</span><span class="p">,</span>
                                        <span class="n">outputTensorDesc</span><span class="p">,</span>
                                        <span class="n">selected</span><span class="o">-&gt;</span><span class="n">solution_id</span><span class="p">);</span>



 <span class="n">miopenConvolutionForwardImmediate</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span>
                                   <span class="n">weightTensor</span><span class="p">,</span>
                                   <span class="n">weight_device_mem</span><span class="p">,</span>
                                   <span class="n">inputTensorDesc</span><span class="p">,</span>
                                   <span class="n">input_device_mem</span><span class="p">,</span>
                                   <span class="n">convDesc</span><span class="p">,</span>
                                   <span class="n">outputTensorDesc</span><span class="p">,</span>
                                   <span class="n">output_device_mem</span><span class="p">,</span>
                                   <span class="n">workspace_device_mem</span><span class="p">,</span>
                                   <span class="n">ws_size</span><span class="p">,</span>
                                   <span class="n">selected</span><span class="o">-&gt;</span><span class="n">solution_id</span><span class="p">);</span>                                                   
</pre></div>
</div>
</div>
<div class="section" id="immediate-mode-fall-back">
<span id="immediate-mode-fall-back"></span><h2>Immediate Mode Fall Back<a class="headerlink" href="#immediate-mode-fall-back" title="Permalink to this headline">¶</a></h2>
<p>The immediate mode is underpinned by the <a class="reference external" href="https://rocmsoftwareplatform.github.io/MIOpen/doc/html/finddb.html">Find-Db</a>, however it may not contain every configuration of interest. Immediate mode's behavior when encountering a database miss is to fallback to a GEMM algorithm. The GEMM algorithm will handle most cases, however, if the user requires performance they should run the Find stage at least once. Fallback's <code class="docutils literal"><span class="pre">miopenConvolution*GetSolution</span></code> returns only one <code class="docutils literal"><span class="pre">miopenConvSolution_t</span></code> structure and its <code class="docutils literal"><span class="pre">time</span></code> member contains negative value. Future releases will implement a more robust heuristic based fallback, which is expected to provide better (but still non-optimal) performance.</p>
</div>
<div class="section" id="limitations-of-immediate-mode">
<span id="limitations-of-immediate-mode"></span><h2>Limitations of Immediate Mode<a class="headerlink" href="#limitations-of-immediate-mode" title="Permalink to this headline">¶</a></h2>
<div class="section" id="architectual-limitations">
<span id="architectual-limitations"></span><h3>Architectual Limitations<a class="headerlink" href="#architectual-limitations" title="Permalink to this headline">¶</a></h3>
<p>The system Find-Db has only been populated for the following architectures:</p>
<ul class="simple">
<li>gfx906 with 64 CUs</li>
<li>gfx906 with 60 CUs</li>
<li>gfx900 with 64 CUs</li>
<li>gfx900 with 56 CUs</li>
</ul>
<p>If the user's architecture is not listed above they will need to run the Find API once on their system per application in order to take advantage of immediate mode's more efficient behavior.</p>
</div>
<div class="section" id="backend-limitations">
<span id="backend-limitations"></span><h3>Backend Limitations<a class="headerlink" href="#backend-limitations" title="Permalink to this headline">¶</a></h3>
<p>OpenCL support for immediate mode via the fallback is limited to fp32 datatypes. This is because this current release's fallback path goes through GEMM which on the OpenCL is serviced through MIOpenGEMM -- which itself only contains support for fp32. The HIP backend uses rocBLAS as its fallback path which contains a richer set of datatypes.</p>
</div>
<div class="section" id="find-modes">
<span id="find-modes"></span><h3>Find Modes<a class="headerlink" href="#find-modes" title="Permalink to this headline">¶</a></h3>
<p>MIOpen provides a set of Find modes which are used to accelerate the Find calls. The different modes are set by using the environment variable <code class="docutils literal"><span class="pre">MIOPEN_FIND_MODE</span></code>, and setting it to one of the values:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">NORMAL</span></code>, or <code class="docutils literal"><span class="pre">1</span></code>: Normal Find: This is the full Find mode call, which will benchmark all the solvers and return a list.</li>
<li><code class="docutils literal"><span class="pre">FAST</span></code>, or <code class="docutils literal"><span class="pre">2</span></code>: Fast Find: Checks the <a class="reference external" href="https://rocmsoftwareplatform.github.io/MIOpen/doc/html/finddb.html">Find-Db</a> for an entry. If there is a Find-Db hit, use that entry. If there is a miss, utilize the Immediate mode fallback. If Start-up times are expected to be faster, but worse GPU performance.</li>
<li><code class="docutils literal"><span class="pre">HYBRID</span></code>, or <code class="docutils literal"><span class="pre">3</span></code>, or unset <code class="docutils literal"><span class="pre">MIOPEN_FIND_MODE</span></code>: Hybrid Find: Checks the <a class="reference external" href="https://rocmsoftwareplatform.github.io/MIOpen/doc/html/finddb.html">Find-Db</a> for an entry. If there is a Find-Db hit, use that entry. If there is a miss, use the existing Find machinery. Slower start-up times than Fast Find, but no GPU performance drop.</li>
</ul>
<p>As of MIOpen 2.6, the default mode is set to <code class="docutils literal"><span class="pre">HYBRID</span></code> mode as default. To run the full <code class="docutils literal"><span class="pre">NORMAL</span></code> Find mode, set the environment as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">MIOPEN_FIND_MODE</span><span class="o">=</span><span class="n">NORMAL</span>
</pre></div>
</div>
<p>Or,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span> <span class="n">export</span> <span class="n">MIOPEN_FIND_MODE</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Getting_Started_FusionAPI.html" class="btn btn-neutral float-right" title="Fusion API: Getting Started" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="finddb.html" class="btn btn-neutral" title="Find-Db Database" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Advanced Micro Devices, Inc.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.7.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>